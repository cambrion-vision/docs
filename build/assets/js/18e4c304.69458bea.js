"use strict";(self.webpackChunkcambrion_doc=self.webpackChunkcambrion_doc||[]).push([[201],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},b=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),b=o,f=u["".concat(l,".").concat(b)]||u[b]||m[b]||a;return n?r.createElement(f,i(i({ref:t},c),{},{components:n})):r.createElement(f,i({ref:t},c))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=b;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:o,i[1]=s;for(var p=2;p<a;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}b.displayName="MDXCreateElement"},5166:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var r=n(7462),o=(n(7294),n(3905));const a={description:"Organizing results with observations",sidebar_position:3},i="The observation object",s={unversionedId:"workflows/observations",id:"workflows/observations",title:"The observation object",description:"Organizing results with observations",source:"@site/docs/workflows/observations.md",sourceDirName:"workflows",slug:"/workflows/observations",permalink:"/docs/workflows/observations",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{description:"Organizing results with observations",sidebar_position:3},sidebar:"defaultSidebar",previous:{title:"Link business data",permalink:"/docs/workflows/linker"},next:{title:"Use-cases",permalink:"/docs/category/use-cases"}},l={},p=[{value:"Bootstrapping an observation",id:"bootstrapping-an-observation",level:2},{value:"Transforming an observation",id:"transforming-an-observation",level:2}],c={toc:p},u="wrapper";function m(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"the-observation-object"},"The observation object"),(0,o.kt)("p",null,"Document contents are typically highly complex. Especially when you want to incorporate layout information in the pipeline calculations. "),(0,o.kt)("p",null,"We modeled the structure of the observation with that in mind. There is a number of things that can be represented with an observation:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Layout information data (like location)"),(0,o.kt)("li",{parentName:"ul"},"Structural relations (like key-value pairs and tables)"),(0,o.kt)("li",{parentName:"ul"},"Attaching business data to text entities"),(0,o.kt)("li",{parentName:"ul"},"Quality measures (text recognition confidence, similarity to business data)"),(0,o.kt)("li",{parentName:"ul"},"Semantic information (text entity labels)")),(0,o.kt)("p",null,"The definition of the observation is part of ",(0,o.kt)("a",{parentName:"p",href:"https://raw.githubusercontent.com/cambrion-vision/api-sepc/main/cambrion_api.yaml"},"Open API Spec"),"."),(0,o.kt)("h2",{id:"bootstrapping-an-observation"},"Bootstrapping an observation"),(0,o.kt)("p",null,"It can be useful to provide document content to a pipeline. For example removing the OCR step from a pipeline a providing recognized text from other sources can greatly improve the run times of a pipeline."),(0,o.kt)("p",null,"This can be done by creating the the observation object manually and add it to an execution. Running the pipeline on the created execution will use the provided observation the perform the calculations."),(0,o.kt)("h2",{id:"transforming-an-observation"},"Transforming an observation"),(0,o.kt)("p",null,"In real-life use-cases it's sometimes tedious to map the observation to business objects. Therefore we integrated ",(0,o.kt)("a",{parentName:"p",href:"https://docs.jsonata.org"},"JSONata")," into the observation API. This was a natural fit since the observation is just a complex JSON object."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'url = f"{CAMBRION_API_ENDPOINT}/executions/import-process/observation/transform"\n\ntransform = "{\\"name\\": **.entities[label = \\"name\\"].block.text,\\"quantity\\": **.entities[label = \\"qty\\"].data.quantityValue,\\"weight\\": **.entities[label = \\"weight\\"].data.numberValue}"\n\nrequests.request("POST", url, data=transform)\n')),(0,o.kt)("p",null,"Using JSONata we easily transform an observation into the required business representation. JSONata features a lot of built-in operators:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"regular expressions"),(0,o.kt)("li",{parentName:"ul"},"date time conversions"),(0,o.kt)("li",{parentName:"ul"},"path operators "),(0,o.kt)("li",{parentName:"ul"},"functions and expressions")),(0,o.kt)("p",null,"And much more..."),(0,o.kt)("p",null,"The full JSONata reference can be found here: ",(0,o.kt)("a",{parentName:"p",href:"https://docs.jsonata.org/overview.html"},"https://docs.jsonata.org/overview.html"),"\nNote that it can be useful to use the JSONata exerciser (",(0,o.kt)("a",{parentName:"p",href:"https://try.jsonata.org"},"https://try.jsonata.org"),") to prototype a JSONata expression. For that you can fetch the observation via the API and then copy and paste the observation into the left field of the exerciser and test your expressions on it."))}m.isMDXComponent=!0}}]);